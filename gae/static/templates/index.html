{% extends "layout.html" %}
{% import 'forms.html' as forms %}

{% block title %}
Algae is an application template for Google App Engine
{% endblock %}

{% block scripts %}
  
{% endblock %}

{% block content %}
<a href="https://github.com/algae"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>
<header class="jumbotron masthead">
  <div class="inner">
    <h1>Algae</h1>
  </div>
  <p>Application Template for Google App Engine</p>
</header>
<div class="tabbable"> 
    <ul id="tabs" class="nav nav-tabs">
      <li class="active"> <a href="#users"><h3><i class="icon-user"></i> Users</h3></a></li>
      <li><a href="#api"><h3><i class="icon-cogs"></i> RESTful APIs<h3></a></li>
      <li><a href="#security"><h3><i class="icon-lock"></i> Security<h3></a></li>
      <li><a href="#css"><h3><i class="icon-tint"></i> LESS Stylesheets<h3></a></li>
      <li class="pull-right"><a href="#about"><h3>About<h3></a></li>
    </ul>
    <div class="tab-content">
      <div class="tab-pane active" id="users">
        <h3>Profiles</h3>

        {% if logged_in %}
          <p>Signed in as <img style="max-width:100px" src = "{{ current_user.pic }}"> via <a href="{{ current_user.profile }}">{{ current_user.username }}</a>. <a href="/logout">Logout</a>
        {% else %}
          No one is signed in. Sign in with:
          <ul>
            <li><a href="/auth/facebook">Facebook</a>
            <li><a href="/auth/twitter">Twitter</a>
            <li><a data-toggle="modal" href="#signup">Sign up</a> or <a data-toggle="modal" href="#signin">Sign in</a> with email
          </ul>
        {% endif %}
        <h3>Sessions</h3>
     
        <p>Reload this page. The number of pageviews should increase. 
    
        <p>Pageviews: {{pageviews}}
      </div>
      <div class="tab-pane span8 " id="api">
        <h3>Create Entity</h3>

        <p>The forms below are automatically generated from model definitions in <code>/gae/model.py</code>. 
        <code>generate_model_form()</code> in <code>/gae/model.py</code> converts the model to a dictionary of template variables, and <code>/gae/static/templates/forms.html</code> macro generates the corresponding HTML.

        <div class="well">
          <span class="label label-info">Heads up!</span>
          Only logged in users are authorized to create new entities. See Security tab for how to modify these rules for your app.
        </div>
        
        {{ forms.form('create', 'Create', '', form) }}
        
        <h3>Update/Delete Entity</h3>
        
        <script id="entity-row" type="text/html">
        <tr>      
          <td data-id=${id}>${id}</td>
          <td>${obj}</td>
          <td>
            <button type="submit" class="btn update_btn" data-id=${id}><i class="icon-edit"></i> Update</button> 
            <button type="submit" class="btn delete_btn" data-id=${id}><i class="icon-trash"></i> Delete</button>
          </td>
        </tr>
        </script>
      
        <table id="entities" class="table table-bordered table-striped">
          <thead>
            <tr>
              <th>ID</th>
              <th class="span3">Summary</th>
              <th class="">Action</th>
            </tr>
          </thead>
          <tbody>
            {% for widget in widgets %}
            <tr>
              <td>{{widget.key().id()}}</td>
              <td>{{widget.str}}</td>
              <td><button type="submit" class="btn update_btn" data-id="{{widget.key().id()}}"><i class="icon-edit"></i> Update</button> 
              <button type="submit" class="btn delete_btn" data-id="{{widget.key().id()}}"><i class="icon-trash"></i> Delete</button></td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        
        <div class="well">
          <span class="label label-info">Heads up!</span>
          Only logged in users are authorized to delete entities. See Security tab for how to modify these rules for your app.
        </div>

        {{ forms.form('update', 'Update', 'disabled', form) }}
      </div>
      <div class="tab-pane span8" id="css">
        <p><span class="app-less-verify">If this text appears in blue</span>, then LESS stylesheets are working. 
        <p><code>/gae/static/css/less/app.less</code> contains application-specific styles. You can recompile updated styles by running 
        <code>npm run-script less</code> from <code>/gae/static</code>
        
        <p>If <code>npm run-script less</code> command fails:</p>
        <ul>
          <li>Install npm.
          <li>Run <code>npm init</code>
          <li>Accept all defaults (keep pressing Enter)
          <li>Run <code>npm install less --save</code> to install LESS
          <li>Run <code>npm run-script less</code> again. 
        </ul>
      </div>
      <div class="tab-pane span8" id="about">
        <p><strong>Algae is designed to get you up to speed and running on Google App Engine in less than 3 minutes and 42 seconds. Guaranteed.</strong></p>

        <p>It integrates de facto industry standards (like Twitter Bootstrap and HTML5 Boilerplate) with features every web app needs, so you don't waste any time re-inventing the wheel.</p>
        <p>Here is what you get:<p>

        <ul>
          <li><a href="http://html5boilerplate.com">HTML5 Boilerplate</a></li>
          <li><a href="http://twitter.github.com/bootstrap/index.html">Twitter Bootstrap</a></li>
          <li><a href="http://lesscss.org/">LESS Stylesheets</a> + <a href="http://fortawesome.github.com/Font-Awesome/">Font Awesome</a></li>
          <li>User account framework, including: 
            <ul>
              <li>Twitter authentication</li>
              <li>Facebook authentication</li>
              <li>Email authentication</li>
              <li>Others - Work in progress</li>
            </ul>
          <li>Plain and RESTful style API bootstrap code:</li>
            <ul>
              <li>Auto-generate HTML forms from GAE data model</li>
              <li>Seamless entity CRUD via AJAX</li>
            </ul>
          <li>jQuery form validation</li>
          <li>Basic testing infrastructure (Work in progress)</li>
          <li>and more..</li>
        </ul>
        
        <p>Finally, an App Engine template you can write home about.</p>
      </div>
      <div class="tab-pane span8" id="security">
        <p>A Python decorator -- <code>@with_login</code> -- can be used on any method of <code>BaseHandler</code> or <code>BaseAPIHandler</code> (or their subclasses) to prevent unauthenticated users from viewing certain pages or calling APIs. </p>

        For instance, this <a href="/login_only">page</a> can only be viewed after you login.
      </div>
  </div>

    <div class="tri-state modal hide" id="signup">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h3>Sign up with your email address</h3>
      </div>
    
      <div class="modal-body">
        <form id="signup_form" class="form-horizontal" name="email-signup">
          <fieldset>
            <div class="control-group">
              <label class="control-label" for="username">Username</label>
              <div class="controls">
                <input type="text" class="input-xlarge required" id="username">
              </div>
            </div>
            <div class="control-group">
              <label class="control-label" for="email">Email address</label>
              <div class="controls">
                <input type="email" class="input-xlarge required email" id="email">
              </div>
            </div>
            <div class="control-group">
              <label class="control-label" for="password_raw">Password</label>
              <div class="controls">
                <input type="password" class="input-xlarge required" id="password_raw">
              </div>
            </div>
          </fieldset>
        </form>
        <div class="form_result"></div>
      </div>
      
      <div class="modal-footer">
        <a id="signup_btn" href="#" class="btn btn-primary submit">Sign Up</a>
      </div>
    </div>
    
    <div class="tri-state modal hide" id="signin">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h3>Sign in</h3>
      </div>
    
      <div class="modal-body">
         <form class="form-horizontal" name="email-signin">
          <fieldset>
            <div class="control-group">
              <label class="control-label" for="email">Email address</label>
              <div class="controls">
                <input type="text" class="input-xlarge required email" id="email">
              </div>
            </div>
            <div class="control-group">
              <label class="control-label" for="password">Password</label>
              <div class="controls">
                <input type="password" class="input-xlarge required" id="password">
              </div>
            </div>
          </fieldset>
        </form>
        <div class="form_result"></div>
      </div>
      <div class="modal-footer">
        <a id="signin_btn" href="#" class="btn btn-primary submit">Sign In</a>
      </div>
    </div>
    
    
{% endblock %}
    